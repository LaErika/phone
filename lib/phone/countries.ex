defmodule Phone.Countries do
  @countries [
    %{regex: ~r/^1(.+)/, module: Phone.NANP},
    %{regex: ~r/^93(.+)/, module: Phone.AF},
    %{regex: ~r/^355(.+)/, module: Phone.AL},
    %{regex: ~r/^213(.+)/, module: Phone.DZ},
    %{regex: ~r/^376(.+)/, module: Phone.AD},
    %{regex: ~r/^244(.+)/, module: Phone.AO},
    %{regex: ~r/^672(.+)/, module: Phone.AQ},
    %{regex: ~r/^54(.+)/, module: Phone.AR},
    %{regex: ~r/^374(.+)/, module: Phone.AM},
    %{regex: ~r/^297(.+)/, module: Phone.AW},
    %{regex: ~r/^61(.+)/, module: Phone.AU},
    %{regex: ~r/^43(.+)/, module: Phone.AT},
    %{regex: ~r/^994(.+)/, module: Phone.AZ},
    %{regex: ~r/^973(.+)/, module: Phone.BH},
    %{regex: ~r/^880(.+)/, module: Phone.BD},
    %{regex: ~r/^375(.+)/, module: Phone.BY},
    %{regex: ~r/^32(.+)/, module: Phone.BE},
    %{regex: ~r/^501(.+)/, module: Phone.BZ},
    %{regex: ~r/^229(.+)/, module: Phone.BJ},
    %{regex: ~r/^975(.+)/, module: Phone.BT},
    %{regex: ~r/^591(.+)/, module: Phone.BO},
    %{regex: ~r/^599(.+)/, module: Phone.BQ},
    %{regex: ~r/^386(.+)/, module: Phone.BA},
    %{regex: ~r/^267(.+)/, module: Phone.BW},
    %{regex: ~r/^55(.+)/, module: Phone.BR},
    %{regex: ~r/^246(.+)/, module: Phone.IO},
    %{regex: ~r/^673(.+)/, module: Phone.BN},
    %{regex: ~r/^359(.+)/, module: Phone.BG},
    %{regex: ~r/^226(.+)/, module: Phone.BR},
    %{regex: ~r/^257(.+)/, module: Phone.BI},
    %{regex: ~r/^855(.+)/, module: Phone.KH},
    %{regex: ~r/^237(.+)/, module: Phone.CM},
    %{regex: ~r/^238(.+)/, module: Phone.CV},
    %{regex: ~r/^236(.+)/, module: Phone.CF},
    %{regex: ~r/^235(.+)/, module: Phone.TD},
    %{regex: ~r/^56(.+)/, module: Phone.CL},
    %{regex: ~r/^86(.+)/, module: Phone.CN},
    %{regex: ~r/^57(.+)/, module: Phone.CO},
    %{regex: ~r/^269(.+)/, module: Phone.KM},
    %{regex: ~r/^242(.+)/, module: Phone.CG},
    %{regex: ~r/^243(.+)/, module: Phone.CD},
    %{regex: ~r/^682(.+)/, module: Phone.CK},
    %{regex: ~r/^506(.+)/, module: Phone.CR},
    %{regex: ~r/^385(.+)/, module: Phone.HR},
    %{regex: ~r/^53(.+)/, module: Phone.CU},
    %{regex: ~r/^599(.+)/, module: Phone.CW},
    %{regex: ~r/^357(.+)/, module: Phone.CY},
    %{regex: ~r/^420(.+)/, module: Phone.CZ},
    %{regex: ~r/^225(.+)/, module: Phone.CI},
    %{regex: ~r/^45(.+)/, module: Phone.DK},
    %{regex: ~r/^253(.+)/, module: Phone.DJ},
    %{regex: ~r/^593(.+)/, module: Phone.EC},
    %{regex: ~r/^20(.+)/, module: Phone.EG},
    %{regex: ~r/^503(.+)/, module: Phone.SV},
    %{regex: ~r/^240(.+)/, module: Phone.GQ},
    %{regex: ~r/^291(.+)/, module: Phone.ER},
    %{regex: ~r/^372(.+)/, module: Phone.EE},
    %{regex: ~r/^251(.+)/, module: Phone.ET},
    %{regex: ~r/^500(.+)/, module: Phone.FK},
    %{regex: ~r/^298(.+)/, module: Phone.FO},
    %{regex: ~r/^679(.+)/, module: Phone.FJ},
    %{regex: ~r/^358(.+)/, module: Phone.FI},
    %{regex: ~r/^33(.+)/, module: Phone.FR},
    %{regex: ~r/^594(.+)/, module: Phone.GF},
    %{regex: ~r/^689(.+)/, module: Phone.PF},
    %{regex: ~r/^262(.+)/, module: Phone.TF},
    %{regex: ~r/^241(.+)/, module: Phone.GA},
    %{regex: ~r/^220(.+)/, module: Phone.GM},
    %{regex: ~r/^995(.+)/, module: Phone.GE},
    %{regex: ~r/^49(.+)/, module: Phone.DE},
    %{regex: ~r/^233(.+)/, module: Phone.GH},
    %{regex: ~r/^350(.+)/, module: Phone.GI},
    %{regex: ~r/^30(.+)/, module: Phone.GR},
    %{regex: ~r/^299(.+)/, module: Phone.GL},
    %{regex: ~r/^590(.+)/, module: Phone.GP},
    %{regex: ~r/^502(.+)/, module: Phone.GT},
    %{regex: ~r/^44(.+)/, module: Phone.GG},
    %{regex: ~r/^224(.+)/, module: Phone.GN},
    %{regex: ~r/^245(.+)/, module: Phone.GW},
    %{regex: ~r/^592(.+)/, module: Phone.GY},
    %{regex: ~r/^509(.+)/, module: Phone.HT},
    %{regex: ~r/^672(.+)/, module: Phone.HM},
    %{regex: ~r/^379(.+)/, module: Phone.VA},
    %{regex: ~r/^504(.+)/, module: Phone.HN},
    %{regex: ~r/^852(.+)/, module: Phone.HK},
    %{regex: ~r/^36(.+)/, module: Phone.HU},
    %{regex: ~r/^354(.+)/, module: Phone.IS},
    %{regex: ~r/^91(.+)/, module: Phone.IN},
    %{regex: ~r/^62(.+)/, module: Phone.ID},
    %{regex: ~r/^98(.+)/, module: Phone.IR},
    %{regex: ~r/^964(.+)/, module: Phone.IQ},
    %{regex: ~r/^353(.+)/, module: Phone.IE},
    %{regex: ~r/^44(.+)/, module: Phone.IM},
    %{regex: ~r/^972(.+)/, module: Phone.IL},
    %{regex: ~r/^39(.+)/, module: Phone.IT},
    %{regex: ~r/^81(.+)/, module: Phone.JP},
    %{regex: ~r/^44(.+)/, module: Phone.JE},
    %{regex: ~r/^962(.+)/, module: Phone.JO},
    %{regex: ~r/^254(.+)/, module: Phone.KE},
    %{regex: ~r/^686(.+)/, module: Phone.KI},
    %{regex: ~r/^850(.+)/, module: Phone.KP},
    %{regex: ~r/^82(.+)/, module: Phone.KR},
    %{regex: ~r/^965(.+)/, module: Phone.KW},
    %{regex: ~r/^996(.+)/, module: Phone.KG},
    %{regex: ~r/^856(.+)/, module: Phone.LA},
    %{regex: ~r/^371(.+)/, module: Phone.LV},
    %{regex: ~r/^961(.+)/, module: Phone.LB},
    %{regex: ~r/^266(.+)/, module: Phone.LS},
    %{regex: ~r/^231(.+)/, module: Phone.LR},
    %{regex: ~r/^218(.+)/, module: Phone.LY},
    %{regex: ~r/^423(.+)/, module: Phone.LI},
    %{regex: ~r/^370(.+)/, module: Phone.LT},
    %{regex: ~r/^352(.+)/, module: Phone.LU},
    %{regex: ~r/^853(.+)/, module: Phone.MO},
    %{regex: ~r/^389(.+)/, module: Phone.MK},
    %{regex: ~r/^261(.+)/, module: Phone.MG},
    %{regex: ~r/^265(.+)/, module: Phone.MW},
    %{regex: ~r/^60(.+)/, module: Phone.MY},
    %{regex: ~r/^960(.+)/, module: Phone.MV},
    %{regex: ~r/^223(.+)/, module: Phone.ML},
    %{regex: ~r/^356(.+)/, module: Phone.MT},
    %{regex: ~r/^692(.+)/, module: Phone.MH},
    %{regex: ~r/^596(.+)/, module: Phone.MQ},
    %{regex: ~r/^222(.+)/, module: Phone.MR},
    %{regex: ~r/^230(.+)/, module: Phone.MU},
    %{regex: ~r/^262(.+)/, module: Phone.YT},
    %{regex: ~r/^52(.+)/, module: Phone.MX},
    %{regex: ~r/^691(.+)/, module: Phone.FM},
    %{regex: ~r/^373(.+)/, module: Phone.MD},
    %{regex: ~r/^377(.+)/, module: Phone.MC},
    %{regex: ~r/^976(.+)/, module: Phone.MN},
    %{regex: ~r/^382(.+)/, module: Phone.ME},
    %{regex: ~r/^212(.+)/, module: Phone.MA},
    %{regex: ~r/^258(.+)/, module: Phone.MZ},
    %{regex: ~r/^95(.+)/, module: Phone.MM},
    %{regex: ~r/^264(.+)/, module: Phone.NA},
    %{regex: ~r/^674(.+)/, module: Phone.NR},
    %{regex: ~r/^977(.+)/, module: Phone.NP},
    %{regex: ~r/^31(.+)/, module: Phone.NL},
    %{regex: ~r/^687(.+)/, module: Phone.NC},
    %{regex: ~r/^64(.+)/, module: Phone.NZ},
    %{regex: ~r/^505(.+)/, module: Phone.NI},
    %{regex: ~r/^227(.+)/, module: Phone.NE},
    %{regex: ~r/^234(.+)/, module: Phone.NG},
    %{regex: ~r/^683(.+)/, module: Phone.NU},
    %{regex: ~r/^672(.+)/, module: Phone.NF},
    %{regex: ~r/^47(.+)/, module: Phone.NO},
    %{regex: ~r/^968(.+)/, module: Phone.OM},
    %{regex: ~r/^92(.+)/, module: Phone.PK},
    %{regex: ~r/^680(.+)/, module: Phone.PW},
    %{regex: ~r/^970(.+)/, module: Phone.PS},
    %{regex: ~r/^507(.+)/, module: Phone.PA},
    %{regex: ~r/^675(.+)/, module: Phone.PG},
    %{regex: ~r/^595(.+)/, module: Phone.PY},
    %{regex: ~r/^51(.+)/, module: Phone.PE},
    %{regex: ~r/^63(.+)/, module: Phone.PH},
    %{regex: ~r/^870(.+)/, module: Phone.PN},
    %{regex: ~r/^48(.+)/, module: Phone.PL},
    %{regex: ~r/^351(.+)/, module: Phone.PT},
    %{regex: ~r/^974(.+)/, module: Phone.QA},
    %{regex: ~r/^40(.+)/, module: Phone.RO},
    %{regex: ~r/^7(.+)/, module: Phone.RU},
    %{regex: ~r/^250(.+)/, module: Phone.RW},
    %{regex: ~r/^262(.+)/, module: Phone.RE},
    %{regex: ~r/^590(.+)/, module: Phone.BL},
    %{regex: ~r/^290(.+)/, module: Phone.SH},
    %{regex: ~r/^590(.+)/, module: Phone.MF},
    %{regex: ~r/^508(.+)/, module: Phone.PM},
    %{regex: ~r/^685(.+)/, module: Phone.WS},
    %{regex: ~r/^378(.+)/, module: Phone.SM},
    %{regex: ~r/^239(.+)/, module: Phone.ST},
    %{regex: ~r/^966(.+)/, module: Phone.SA},
    %{regex: ~r/^221(.+)/, module: Phone.SN},
    %{regex: ~r/^381(.+)/, module: Phone.RS},
    %{regex: ~r/^248(.+)/, module: Phone.SC},
    %{regex: ~r/^232(.+)/, module: Phone.SL},
    %{regex: ~r/^65(.+)/, module: Phone.SG},
    %{regex: ~r/^421(.+)/, module: Phone.SK},
    %{regex: ~r/^386(.+)/, module: Phone.SI},
    %{regex: ~r/^677(.+)/, module: Phone.SB},
    %{regex: ~r/^252(.+)/, module: Phone.SO},
    %{regex: ~r/^27(.+)/, module: Phone.ZA},
    %{regex: ~r/^500(.+)/, module: Phone.GS},
    %{regex: ~r/^211(.+)/, module: Phone.SS},
    %{regex: ~r/^34(.+)/, module: Phone.ES},
    %{regex: ~r/^94(.+)/, module: Phone.LK},
    %{regex: ~r/^249(.+)/, module: Phone.SD},
    %{regex: ~r/^597(.+)/, module: Phone.SR},
    %{regex: ~r/^268(.+)/, module: Phone.SZ},
    %{regex: ~r/^46(.+)/, module: Phone.SE},
    %{regex: ~r/^41(.+)/, module: Phone.CH},
    %{regex: ~r/^963(.+)/, module: Phone.SY},
    %{regex: ~r/^886(.+)/, module: Phone.TW},
    %{regex: ~r/^992(.+)/, module: Phone.TJ},
    %{regex: ~r/^255(.+)/, module: Phone.TZ},
    %{regex: ~r/^66(.+)/, module: Phone.TH},
    %{regex: ~r/^670(.+)/, module: Phone.TL},
    %{regex: ~r/^228(.+)/, module: Phone.TG},
    %{regex: ~r/^690(.+)/, module: Phone.TK},
    %{regex: ~r/^676(.+)/, module: Phone.TO},
    %{regex: ~r/^216(.+)/, module: Phone.TN},
    %{regex: ~r/^90(.+)/, module: Phone.TR},
    %{regex: ~r/^993(.+)/, module: Phone.TM},
    %{regex: ~r/^688(.+)/, module: Phone.TV},
    %{regex: ~r/^256(.+)/, module: Phone.UG},
    %{regex: ~r/^380(.+)/, module: Phone.UA},
    %{regex: ~r/^971(.+)/, module: Phone.AE},
    %{regex: ~r/^44(.+)/, module: Phone.GB},
    %{regex: ~r/^598(.+)/, module: Phone.UY},
    %{regex: ~r/^998(.+)/, module: Phone.UZ},
    %{regex: ~r/^678(.+)/, module: Phone.VU},
    %{regex: ~r/^58(.+)/, module: Phone.VE},
    %{regex: ~r/^84(.+)/, module: Phone.VN},
    %{regex: ~r/^681(.+)/, module: Phone.WF},
    %{regex: ~r/^212(.+)/, module: Phone.EH},
    %{regex: ~r/^967(.+)/, module: Phone.YE},
    %{regex: ~r/^260(.+)/, module: Phone.ZM},
    %{regex: ~r/^263(.+)/, module: Phone.ZW},
    %{regex: ~r/^358(.+)/, module: Phone.AX}
  ]

  def match(number) do
    element = Enum.filter(@countries, fn(x) -> Regex.match?(x.regex,number) end)
    Phone.Countries.caller(element, number)
  end

  def caller([], number) do
    raise ArgumentError, message: "Not a valid phone number."
  end

  def caller([element], number) do
    [[_ | number]] = Regex.scan(element.regex, number)
    element.module.match(number)
  end

end
